---
import SEO from '../components/SEO.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import WhatsAppButton from '../components/WhatsAppButton.astro';
import '../styles/global.css';

interface Props {
	title: string;
	description?: string;
}

const { title, description = "Fagaz SA - Servicios Industriales Integrales" } = Astro.props;
---

<!doctype html>
<html lang="es" class="scroll-smooth">
	<head>
		<SEO title={title} description={description} />
		<style>
			/* Preloader Styles */
			#preloader {
				position: fixed;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				background: #ffffff;
				display: flex;
				align-items: center;
				justify-content: center;
				z-index: 9999;
				transition: opacity 0.5s ease-out, visibility 0.5s ease-out;
			}

			#preloader.fade-out {
				opacity: 0;
				visibility: hidden;
			}

			.preloader-logo {
				width: 120px;
				height: auto;
				filter: brightness(0) saturate(100%) invert(21%) sepia(45%) saturate(2345%) hue-rotate(234deg) brightness(91%) contrast(93%);
				animation: pulse 1.5s ease-in-out infinite;
			}

			@keyframes pulse {
				0%, 100% {
					transform: scale(1);
					opacity: 1;
				}
				50% {
					transform: scale(1.1);
					opacity: 0.8;
				}
			}

			/* Hide content until preloader is done */
			body.loading {
				overflow: hidden;
			}
		</style>
	</head>
	<body class="loading bg-background-light dark:bg-background-dark text-[#111118] font-display antialiased overflow-x-hidden flex flex-col min-h-screen">
		<!-- Preloader -->
		<div id="preloader">
			<img src="/logotipo.png" alt="Fagaz SA" class="preloader-logo" />
		</div>

		<Header />
		<main class="flex-grow">
			<slot />
		</main>
		<Footer />
		<WhatsAppButton />

		<script>
			// Hide preloader when page is loaded
			window.addEventListener('load', () => {
				const preloader = document.getElementById('preloader');
				const body = document.body;
				
				if (preloader) {
					// Add fade-out class
					preloader.classList.add('fade-out');
					
					// Remove loading class from body
					body.classList.remove('loading');
					
					// Remove preloader from DOM after animation
					setTimeout(() => {
						preloader.remove();
					}, 500);
				}
			});

			// Fallback: hide preloader after 3 seconds if load event doesn't fire
			setTimeout(() => {
				const preloader = document.getElementById('preloader');
				if (preloader && !preloader.classList.contains('fade-out')) {
					preloader.classList.add('fade-out');
					document.body.classList.remove('loading');
					setTimeout(() => preloader.remove(), 500);
				}
			}, 3000);
		</script>
	</body>
</html>
